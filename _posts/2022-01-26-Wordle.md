---
layout: post
title: Can WORDLE be always solved?
date:   2022-1-26T2:51:45+00:00
author: plonzari
categories: 
            - numbers
            - python
---

In the past months the Twitter has been overtaken by stacks of colored boxes. It is the fault of a 
new words-game: <a href="https://www.powerlanguage.co.uk/wordle/"> WORDLE. </a> Free and with a minimalistic design the game has 
received a well deserved attention.

<div style="text-align: center">
<a href="https://www.powerlanguage.co.uk/wordle/"> 
<img src="{{ site.baseurl }}/assets/images/WordleDesign.png" width="500" /></a>
</div>>

Each day a five letters word is proposed and you have six tries to guess it. For each guess the letters that in your guess which 
can be found in the solution are highlighted (orange for letters found in the same position and blue if not).

By now one can find quite a few articles discussing winning strategies and even web apps offering word suggestions 
for  the game. Given the apparent simplicity of the game I want a more exact answer to simple questions: can the game 
be solved for any proposed solution word? which is the best starting word?
The short answer is yes, there is a strategy to always find the answer in six words and less. 
And my best starting 
word is <a href="https://www.collinsdictionary.com/dictionary/english/laten"> LATEN. </a>

Let us start with properly setting up the game. One starts with a list (L) of possible guesses. For the original game
this list contains 12972 five letters words, some of them quite obscure. The solutions are chosen from a smaller 
sublist list (A) of 2315 more common words. We suppose the choice to be uniformly random. The 
goal is to always find the solution using less than six guesses. If the solution can always be found
we want to minimize the average number of guesses.


The game is defined by a directed graph where each node is a possible color configuration. The children of each 
node are the color configurations that can be obtained by adding another guess, for each possible guess and each 
possible solution compatible with the node. Let us suppose that we start with the word TRACE and the solution is 
either BELIE or BIBLE. A portion of the game tree would look like this:


<div style="text-align: center">
<a href="https://www.powerlanguage.co.uk/wordle/"> 
<img src="{{ site.baseurl }}/assets/images/WordleDiagram.png" width="500" /></a>
</div>>

The actual root of the tree is the empty configuration with 12972 x 2315 children on the first level.
An important feature of each node (configuration) $$C$$ is the set $$S(C)$$ of solutions compatible  with it. 
If this set contains only one solution, we can "guess" it at the next step and the game ends. The tree has 
therefore five levels and the leaves are of two types:

1. nodes with only one compatible solution. They correspond to a correct guess at the next step.
2. nodes with more than one compatible solution on the fifth level. They correspond to a (possible) loss.

With each node we can associate a minimal average number of extra guesses needed to win, starting from that node,
let us call it $$g(C)$$. Each leaf of type one has by definition $$g(C)=1$$ and each leaf of type two has
$$g(C)=g_{loss}$$ where $$g_{loss}$$ is some big number. One can thus derive a <b> master equation:</b>

$$ g(C) =1+MIN_{All\, guesses,\, w} \left( \frac{\sum_{All\, solutions\, in\, S(C),\, s} g(C_{s,w})}{|S(C)|} \right) $$

where $$C_{s,w}$$ is the child of the node (configuration) $$C$$ obtained by adding the guess $$w$$ when 
the solution 
is $$s$$. This is a mathematical form of the intuition that the number of guesses still needed to solve 
the game if starting at node $$C$$ is one unit larger than what is needed starting from the best configuration
that can be reached in one step from $$C$$, averaged over all the possible solutions.

Once solved, the master equation can answer all our questions and also provides the perfect strategy at 
every step. The game can always be solved in less than six steps if and only if the solution of the master 
equation is independent of $$g_{loss}$$. Then the child of the root with the highest average $$g$$ provides 
the perfect guess. The value of $$g$$ at the root is the average number of guesses from the start of the game 
until the solution is found.
Unfortunately the full tree is quite big and very difficult to solve on my system, therefore a 
few shortcuts are needed. 

First I use the observation that if one inputs the words TROMP, RUGBY, FLANK, WHIST and CAVED, the resulting
configuration is unique for <b>most</b> possible solutions (thus providing the correct guess at the last step). 
Unfortunately there remain 13 pairs of solutions that cannot be thus distinguished, like MELON and LEMON or 
BIBLE and BELIE. The search is ongoing, as the existence of
a quintuple of words with unique configurations for each solution is a sufficient  (but not necessary) condition
for the game to be solvable for any solution.


Inspired by this, one can restrict the list of possible guesses. Obviously a game where not all words are 
allowed would provide a bound for the best strategy. Indeed, using only the 9 words LATEN, CRISP, DOUGH,
 <a href="https://www.collinsdictionary.com/dictionary/english/womby"> WOMBY, </a>
FLAKS, SERVE, RIGOL, BLOND, and TESTY as guesses one can always solve WORDLE in 3.9 steps in 
average.  Check out a 
text solver <a href="https://github.com/plonzari/Wordle"> here. </a> The very best strategy 
probably needs many more words for the guesses but then the game tree gets too big. 
Next step would 
be to use the same approach for the 
Hard Mode of the game. Because in that mode any "hints must be used in subsequent guesses" 
the game-tree should be much smaller, as many combinations of guesses are not allowed.

**UPDATE.** I found a smaller set of guesses that can solve for all 2315 solutions with
only 8 guesses:  
<a href="https://www.thefreedictionary.com/anted"> ANTED, </a>
CRISP, WOMBY, FLAKS, RIGOL,
<a href="https://www.thefreedictionary.com/anted"> LOUGH, </a>
<a href="https://www.thefreedictionary.com/lurve"> LURVE, </a>
<a href="https://www.thefreedictionary.com/lurve"> THOFT, </a>  starting with ANTED. In average the
best strategy with these words takes 3.92 steps.


**UPDATE 2.** The best word to start a game of is WORDLE with is 
<a href="https://www.thefreedictionary.com/reast"> REAST, </a> with TRACE a close second.
The best strategy takes, in average, 3.40 steps. This result can be obtained by optimizing a branch and bound algorithm
to explore all the best paths in the game tree. Below I compiled a cheatsheet for the second word to try after REAST.
Each cell of the table contains a possible configuration, most useful guess and the average number of steps remaining.
The configurations are encoded with capitals for correct letters in position and minuscules for correct letters out of 
position. Sometimes there is no guess which means that there are either one or two possible solutions remaining. A 
score of 2.0 means that after using the provided guess only one possible solution remains.


|---------------------|----------------------|----------------------|
| .....  godly 2.797 | ....t  hound 2.515 | ...s.  plink 2.53 | ...st  mouch 2.4   | 
| ..a..  colin 2.59  | ..a.t  colin 2.541 | ..as.  yulan 2.28 | ..ast  phony 2.125 | 
| .e...  lined 2.693 | .e..t  toile 2.303 | .e.s.  clipe 2.434| .e.st  pleon 2.214 | 
| .ea..  angle 2.558 | .ea.t  latch 2.166 | .eas.  slink 1.9  | .east  whelp 2.454 | 
| r....  could 2.611 | r...t  throw 2.322 | r..s.  scoup 2.285 | r..st  mucky 1.799 | 
| r.a..  carom 2.516 | r.a.t  podal 2.0   | r.as.  apron 1.875 | r.ast  bawdy 1.75 | 
| re...  pined 2.804 | re..t  bowie 2.483 | re.s.  shown 2.384 | re.st  sonic 1.75 | 
| rea..  pagle 2.642 | rea.t  latch 2.307 | reas.  whelp 2.166 | ....T  login 2.314 | 
| ...sT  pinch 2.235 | ..a.T  fluid 2.464 | ..asT  clink 1.75 | .e..T  clink 2.272 | 
| .e.sT  pleon 2.076 | .ea.T  cheap 1.909 | .easT  ..... 1.5 | r...T  groin 1.933 | 
| r..sT  porch 1.857 | r.a.T  table 1.666 | re..T  erugo 2.0 | rea.T  agile 1.75 | 
| ...S.  spoil 2.272 | ...St  ..... 1.0 | ..aS.  spiny 1.888 | ..aSt  ..... 1.0 | 
| .e.S.  clone 2.318 | .e.St  ..... 1.5 | .eaS.  chump 1.857 | r..S.  combi 2.111 | 
| r..St  ..... 1.5 | r.aS.  ..... 1.5 | r.aSt  ..... 1.0 | re.S.  porch 1.9 | 
| reaS.  inbox 1.666 | ...ST  himbo 2.111 | ..aST  ..... 1.5 | .e.ST  query 1.75 | 
| r..ST  torus 1.875 | re.ST  ..... 1.5 | ..A..  clink 2.351 | ..A.t  homer 1.666 | 
| ..As.  plonk 2.28 | ..Ast  plink 2.1 | .eA..  flimp 2.38 | .eA.t  elbow 1.799 | 
| .eAs.  mulch 2.307 | .eAst  kelty 2.142 | r.A..  blind 2.439 | r.A.t  pinch 1.857 | 
| .....  godly 2.797 | ....t  hound 2.515 | ...s.  plink 2.53  | ...st  mouch 2.4   | 
| ..a..  colin 2.59  | ..a.t  colin 2.541 | ..as.  yulan 2.28  | ..ast  phony 2.125 | 
| .e...  lined 2.693 | .e..t  toile 2.303 | .e.s.  clipe 2.434 | .e.st  pleon 2.214 | 
| .ea..  angle 2.558 | .ea.t  latch 2.166 | .eas.  slink 1.9   | .east  whelp 2.454 | 
| r....  could 2.611 | r...t  throw 2.322 | r..s.  scoup 2.285 | r..st  mucky 1.799 | 
| r.a..  carom 2.516 | r.a.t  podal 2.0   | r.as.  apron 1.875 | r.ast  bawdy 1.75  | 
| re...  pined 2.804 | re..t  bowie 2.483 | re.s.  shown 2.384 | re.st  sonic 1.75  | 
| rea..  pagle 2.642 | rea.t  latch 2.307 | reas.  whelp 2.166 | ....T  login 2.314 | 
| ...sT  pinch 2.235 | ..a.T  fluid 2.464 | ..asT  clink 1.75  | .e..T  clink 2.272 | 
| .e.sT  pleon 2.076 | .ea.T  cheap 1.909 | .easT  ..... 1.5   | r...T  groin 1.933 | 
| r..sT  porch 1.857 | r.a.T  table 1.666 | re..T  erugo 2.0   | rea.T  agile 1.75  | 
| ...S.  spoil 2.272 | ...St  ..... 1.0   | ..aS.  spiny 1.888 | ..aSt  ..... 1.0   | 
| .e.S.  clone 2.318 | .e.St  ..... 1.5   | .eaS.  chump 1.857 | r..S.  combi 2.111 | 
| r..St  ..... 1.5   | r.aS.  ..... 1.5   | r.aSt  ..... 1.0   | re.S.  porch 1.9   | 
| reaS.  inbox 1.666 | ...ST  himbo 2.111 | ..aST  ..... 1.5   | .e.ST  query 1.75  | 
| r..ST  torus 1.875 | re.ST  ..... 1.5   | ..A..  clink 2.351 | ..A.t  homer 1.666 | 
| ..As.  plonk 2.28  | ..Ast  plink 2.1   | .eA..  flimp 2.38  | .eA.t  elbow 1.799 | 
| .eAs.  mulch 2.307 | .eAst  kelty 2.142 | r.A..  blind 2.439 | r.A.t  pinch 1.857 | 
| r.As.  lymph 2.125 | r.Ast  ..... 1.5   | reA..  crags 2.611 | reA.t  child 1.799 | 
| reAs.  chump 1.75  | reAst  ..... 1.0   | ..A.T  phony 1.833 | ..AsT  fable 1.75  | 
| .eA.T  clink 1.666 | r.A.T  pinch 2.222 | r.AsT  ..... 1.5   | ..AS.  chums 2.25  | 
| ..ASt  ..... 1.0   | .eAS.  chump 1.666 | r.AS.  crags 2.0   | r.ASt  ..... 1.0   | 
| reAS.  ..... 1.0   | ..AST  table 1.75  | .E...  lynch 2.553 | .E..t  duply 2.187 | 
| .E.s.  miked 2.0   | .E.st  torus 1.799 | .Ea..  podal 2.2   | .Ea.t  impel 1.75  | 
| .Eas.  ..... 1.5   | rE...  duply 2.516 | rE..t  golem 1.799 | rE.s.  vigor 1.799 | 
| rEa..  bawdy 1.75  | rEa.t  ..... 1.0   | .E..T  inbox 1.833 | .E.sT  ..... 1.0   | 
| .Ea.T  ..... 1.0   | rE..T  ..... 1.5   | .E.S.  shown 1.75  | .E.St  ..... 1.0   | 
| rE.S.  ..... 1.5   | rE.St  ..... 1.0   | .E.ST  ..... 1.0   | .EA..  lymph 2.153 | 
| .EA.t  decoy 1.75  | rEA..  blind 1.833 | rEA.t  ..... 1.0   | .EA.T  mound 1.75  | 
| rEA.T  ..... 1.0   | .EAS.  lodge 1.666 | .EASt  ..... 1.0   | .EAST  fable 1.75  | 
| R....  mound 1.916 | R...t  ..... 1.0   | R..s.  ..... 1.0   | R..st  ..... 1.0   | 
| R.a..  indol 2.166 | R.a.t  ..... 1.5   | R.as.  ..... 1.0   | Re...  vigor 2.25  | 
| Re..t  ..... 1.0   | Re.s.  ..... 1.5   | Rea..  munch 1.799 | R...T  ..... 1.5   | 
| Re..T  ..... 1.0   | Re.S.  ..... 1.5   | ReaS.  ..... 1.0   | R..ST  ..... 1.0   | 
| R.A..  ..... 1.0   | R.AST  ..... 1.0   | RE...  viner 2.166 | RE..t  savoy 1.666 | 
| RE.s.  ..... 1.5   | REa..  lynch 2.125 | RE..T  chump 1.75  | RE.sT  ..... 1.0   |




